(this["webpackJsonpenactive-integration-ui"]=this["webpackJsonpenactive-integration-ui"]||[]).push([[0],{167:function(e,t,n){"use strict";n.r(t);var o=n(0),i=n.n(o),a=n(21),r=n.n(a),c=n(7),l=n(187),s=n(183),u=n(66),d=n.n(u),p=n(6),v=n(184),b={contrastText:"#fff",main:"#8d4a99"},f=Object(p.a)(Object(p.a)({},{color:"rgba(0, 0, 0, 0.87)"}),{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:16}),x={"& button":Object(p.a)(Object(p.a)(Object(p.a)({},f),{alignContent:"center",alignItems:"center",borderRadius:"0.4em",cursor:"pointer",display:"inline-flex",flexDirection:"row",justifyContent:"center",lineHeight:"1.5em",margin:0,minWidth:"5em",overflow:"hidden",padding:"0.6em 0.8em",position:"relative",transition:"background 100ms linear",zIndex:1}),{},{background:"rgba(0, 0, 0, 0)",border:"none",boxShadow:"none"}),"& button::before":{background:"#000",bottom:0,content:'""',left:0,opacity:0,position:"absolute",right:0,top:0,zIndex:-1},"& button:active::before, & button:hover::before, & button:focus::before":{opacity:.07},"& button:disabled":{cursor:"default",opacity:.5,pointerEvents:"none"},"& div.enactive-buttongroup":{margin:"-0.5em"},"& div.enactive-buttongroup button":{margin:"0.5em"}},m={"& button.enactive-primary":{color:b.contrastText},"& button.enactive-primary::before":{background:b.main,opacity:1},"& button.enactive-primary:active::before, & button.enactive-primary:hover::before, & button.enactive-primary:focus::before":{opacity:.85}},j=Object(p.a)(Object(p.a)(Object(p.a)({},x),{"& button.enactive-contained":{boxShadow:"0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12)"},"& button.enactive-contained::before":{opacity:.07},"& button.enactive-contained:active::before, & button.enactive-contained:hover::before, & button.enactive-contained:focus::before":{opacity:0}}),m),h=Object(v.a)("div")(Object(p.a)(Object(p.a)(Object(p.a)({},f),j),{},{"& p":Object(p.a)(Object(p.a)({},f),{},{margin:"1em 0"})})),g=n(185),O=n(1),y=Object(v.a)("div")({"&, &.enter, &.exit.exit-active, &.exit-done":{opacity:0,pointerEvents:"none"},"&.enter-active, &.exit-active":{transition:"opacity 250ms linear"},"&.enter.enter-active, &.enter-done, &.exit":{opacity:1,pointerEvents:"auto"},borderColor:"rgba(0, 0, 0, 0.7)",borderStyle:"solid",bottom:0,left:0,position:"fixed",right:0,top:0,zIndex:1111}),w=function(e){var t=e.active,n=e.children,o=e.onOutEnd,a=void 0===o?function(){}:o,r=e.ref,c=e.style,l=i.a.useRef(null);return Object(O.jsx)(g.a,{in:t,onExited:a,nodeRef:l,timeout:250,children:Object(O.jsx)(y,{ref:function(e){l.current=e,null===r||void 0===r||r(e)},style:c,children:n})})},E=Object(v.a)("div")({display:"flex"}),S=Object(v.a)(E)({alignItems:"stretch",flexDirection:"column",justifyContent:"flex-start"}),C=Object(v.a)(E)({alignItems:"center",justifyContent:"center"}),R=Object(v.a)("div")({flex:1}),k=(Object(v.a)("div")({}),n(72)),I=n(182),A=function(e){var t=e.anchorEl,n=e.children,o=e.offset,a=void 0===o?0:o,r=e.open,l=e.placement,s=Object(k.a)(e,["anchorEl","children","offset","open","placement"]),u=i.a.useState(null),d=Object(c.a)(u,2),v=d[0],b=d[1],f=Object(I.a)(t,v,{modifiers:[{name:"offset",options:{offset:[0,a]}}],placement:l}),x=f.attributes,m=f.styles;return Object(O.jsx)("div",Object(p.a)(Object(p.a)(Object(p.a)({ref:b},s),{},{style:Object(p.a)(Object(p.a)(Object(p.a)({},s.style),m.popper),r?void 0:{pointerEvents:"none",visibility:"hidden"})},x.popper),{},{children:n}))},T=Object(v.a)(R)({minWidth:"20em",padding:"1em"}),L=Object(v.a)(C)({"& > button":{margin:"0.25em"},justifyContent:"flex-end",margin:"-0.25em",padding:"1em"}),W=Object(v.a)("div")({bottom:"2em",height:"auto",maxWidth:"35em",position:"fixed",right:"2em"}),M=Object(v.a)(S)({backgroundColor:"white",borderRadius:"1em",position:"relative"}),z=Object(v.a)("div")({"&, &.enter, &.exit.exit-active, &.exit-done":{opacity:0,top:"2em"},"&.enter-active, &.exit-active":{transition:"opacity 250ms ease-in, top 250ms ease-in"},"&.enter.enter-active, &.enter-done, &.exit":{opacity:1,top:0},'[data-popper-placement="bottom"] &::before':{left:"calc(50% - 0.5em)",top:"-0.5em"},'[data-popper-placement="left"] &::before':{right:"-0.5em",top:"calc(50% - 0.5em)"},'[data-popper-placement="right"] &::before':{left:"-0.5em",top:"calc(50% - 0.5em)"},'[data-popper-placement="top"] &::before':{bottom:"-0.5em",left:"calc(50% - 0.5em)"},"[data-popper-placement] &::before":{backgroundColor:"white",boxShadow:"0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 5px 8px 0px rgba(0, 0, 0, 0.14), 0px 1px 14px 0px rgba(0, 0, 0, 0.12)",content:'""',display:"block",height:"1em",position:"absolute",transform:"rotate(45deg)",width:"1em"},borderRadius:"1em",boxShadow:"0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 5px 8px 0px rgba(0, 0, 0, 0.14), 0px 1px 14px 0px rgba(0, 0, 0, 0.12)",position:"relative"}),D=function(e){var t=e.anchorEl,n=e.buttons,o=void 0===n?[]:n,a=e.children,r=e.onOutEnd,l=void 0===r?function(){}:r,s=e.open,u=i.a.useRef(null),d=i.a.useState(s),v=Object(c.a)(d,2),b=v[0],f=v[1],x=i.a.useState(!1),m=Object(c.a)(x,2),j=m[0],h=m[1];return i.a.useEffect((function(){!s||b||j?j&&(f(!1),h(!1)):f(!0)}),[s,b,j]),void 0!==t?Object(O.jsx)(A,{anchorEl:t,offset:12,open:b,placement:"right",style:{maxWidth:"35em",zIndex:1112},children:Object(O.jsx)(g.a,{onExited:function(){h(!0),l()},in:s,nodeRef:u,timeout:250,children:Object(O.jsx)(z,{ref:u,children:Object(O.jsxs)(M,{children:[Object(O.jsx)(T,{children:a}),o.length>0?Object(O.jsx)(L,{children:o}):void 0]})})})}):Object(O.jsx)(W,{style:Object(p.a)({zIndex:1112},s?void 0:{pointerEvents:"none"}),children:Object(O.jsx)(g.a,{onExited:function(){h(!0),l()},in:s,nodeRef:u,timeout:250,children:Object(O.jsx)(z,{ref:u,children:Object(O.jsxs)(M,{children:[Object(O.jsx)(T,{children:a}),o.length>0?Object(O.jsx)(L,{children:o}):void 0]})})})})},N=function(e){var t=e.active,n=e.buttons,o=e.html,i=e.onAction,a=e.onOut,r=void 0===a?function(){}:a,c=e.targetEl;return Object(O.jsx)(D,{anchorEl:c,buttons:n.map((function(e){return[Object(O.jsx)("button",{onClick:function(){return i(e.action)},children:e.text},e.action)]})),open:t,onOutEnd:r,children:Object(O.jsx)("div",{dangerouslySetInnerHTML:{__html:o}})})},F=function(e){var t=e.onAction,n=e.onComplete,o=e.tour,a=i.a.useState(-1),r=Object(c.a)(a,2),l=r[0],s=r[1],u=i.a.useState(),d=Object(c.a)(u,2),p=d[0],v=d[1],b=i.a.useState(window.scrollY),f=Object(c.a)(b,2)[1],x=i.a.useMemo((function(){return o.map((function(e){var t;return{step:e,targetEl:null!==(t=function(){var t;switch(null===(t=e.selector)||void 0===t?void 0:t.type){case"css":return document.querySelector(e.selector.value);case"xpath":return document.evaluate(e.selector.value,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;case void 0:return null}}())&&void 0!==t?t:void 0}}))}),[o]);return i.a.useEffect((function(){setTimeout((function(){return s(0)}),1e3);var e=function(){return f(window.scrollY)};return window.addEventListener("scroll",e),function(){return window.removeEventListener("scroll",e)}}),[]),Object(O.jsx)(O.Fragment,{children:x.map((function(e,i){var a,r=e.step,c=e.targetEl;return Object(O.jsxs)("div",{children:[r.mask?Object(O.jsx)(w,{active:-1!==p&&(l===i&&void 0===p||p===i),style:function(){var e,t,n,o,i=null===c||void 0===c?void 0:c.getBoundingClientRect(),a=null!==(e=null===i||void 0===i?void 0:i.x)&&void 0!==e?e:0,r=null!==(t=null===i||void 0===i?void 0:i.y)&&void 0!==t?t:0,l=null!==(n=null===i||void 0===i?void 0:i.width)&&void 0!==n?n:0,s=null!==(o=null===i||void 0===i?void 0:i.height)&&void 0!==o?o:0;return{borderBottomWidth:"calc(100vh - ".concat(r+s,"px)"),borderLeftWidth:null===i||void 0===i?void 0:i.x,borderRightWidth:"calc(100vw - ".concat(a+l,"px)"),borderTopWidth:null===i||void 0===i?void 0:i.y}}()},"mask-".concat(i)):void 0,Object(O.jsx)(N,{active:void 0===p&&l===i,buttons:null!==(a=r.buttons)&&void 0!==a?a:[{action:"dismiss",text:"Dismiss"},i<o.length-1?{action:"next",text:"Next"}:void 0].filter((function(e){return void 0!==e})),html:r.html,onAction:function(e){switch(t(r.id,i,e),e){case"dismiss":return v(-1);case"next":return v(i+1)}},onOut:function(){-1===p?n():void 0!==p&&(s(p),v(void 0))},targetEl:c},"popup-".concat(i))]},i)}))})},H=n(35),P=n(69),_=n.n(P),J=n(33),U=n.n(J),q=n(186);function B(e,t,n){void 0!==e[t]&&null!==e[t]||(e[t]=n)}var Y=(new _.a).compile({properties:{apiHost:{type:"string"},context:{nullable:!0,properties:{device:{nullable:!0,properties:{locale:{nullable:!0,type:"string"}},type:"object"},page:{nullable:!0,properties:{locale:{nullable:!0,type:"string"},url:{nullable:!0,type:"string"}},type:"object"},user:{nullable:!0,properties:{anonymous:{nullable:!0,type:"boolean"},id:{nullable:!0,type:"string"},locale:{nullable:!0,type:"string"}},type:"object"}},type:"object"},siteId:{type:"string"}},type:"object"}),$="script[enactive\\.site-id]",V=function(){var e=i.a.useMemo((function(){var e;return null!==(e=document.querySelector($))&&void 0!==e?e:void 0}),[]),t=i.a.useMemo((function(){return function(e){if(void 0!==e){var t,n=new URLSearchParams,o=Object(H.a)(e.attributes);try{for(o.s();!(t=o.n()).done;){var i=t.value;!0===i.name.startsWith("enactive.")&&n.append(i.name.substring(9),i.value)}}catch(r){o.e(r)}finally{o.f()}if(!1===n.has("api-host")){var a=document.createElement("a");a.href=e.src,n.append("api-host","api.".concat(a.hostname.replace("www.","")))}return n.sort(),n.toString()}return""}(e)}),[e]),n=i.a.useState(),o=Object(c.a)(n,2),a=o[0],r=o[1],l=i.a.useState(),s=Object(c.a)(l,2),u=s[0],d=s[1],p=i.a.useState(),v=Object(c.a)(p,2),b=v[0],f=v[1];return i.a.useEffect((function(){var e=function(){try{var e,t;return null!==(e=JSON.parse(null!==(t=localStorage.getItem("enactive-context"))&&void 0!==t?t:"null"))&&void 0!==e?e:void 0}catch(n){}}();if(void 0===e){var t={user:{anonymous:!0,id:Object(q.a)()}};r(t);try{localStorage.setItem("enactive-context",JSON.stringify(t))}catch(n){console.warn("Failed to set enactive device data in storage.",n)}}else r(e)}),[]),i.a.useEffect((function(){return d(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.selector,o=void 0===n?"":n,i=t.script,a=void 0===i?void 0:i;if(void 0===e)return void console.warn("Could not locate enactive script tag with metadata",{script:a,selector:o});var r,l={},s=new URLSearchParams(e).entries(),u=Object(H.a)(s);try{for(u.s();!(r=u.n()).done;){var d,p=Object(c.a)(r.value,2),v=p[0],b=p[1],f=X(v),x=Object(c.a)(f,2),m=x[0],j=x[1],h=l,g=Object(H.a)(m);try{for(g.s();!(d=g.n()).done;){var O=d.value;O in h&&"object"!==typeof h[O]&&console.warn("Assigned both a value and an object on enactive script tag metadata",{script:a,selector:o}),h=O in h?h[O]:h[O]={}}}catch(E){g.e(E)}finally{g.f()}j in h&&console.warn("Assigned duplicate values on enactive script tag metadata",{script:a,selector:o}),h[j]=b}}catch(E){u.e(E)}finally{u.f()}var y,w;if(Y(l))return void 0!==(null===(y=l.context)||void 0===y||null===(w=y.user)||void 0===w?void 0:w.id)&&B(l.context.user,"anonymous",!1),l;console.warn("Invalid enactive script tag metadata",{errors:Y.errors,result:l,script:a,selector:o})}(t,{script:e,selector:$}))}),[t,e]),i.a.useEffect((function(){f(void 0!==a&&void 0!==u?U()({},{context:a},u):void 0)}),[u,a]),i.a.useEffect((function(){console.log({localStorageContext:a,metadata:b,scriptMetadata:u})}),[a,b,u]),b};function X(e){var t,n,o=(n=e,n.replaceAll(/^\.+|\.+$/g,"").replaceAll(/\.+/g,".").split(".")).map(G),i=null!==(t=o.pop())&&void 0!==t?t:"";return[o,i]}function G(e){return e.replaceAll(/^-+|-+$/g,"").replaceAll(/-+/g,"-").split("-").map((function(e,t){return t>0&&e.length>0?"".concat(e[0].toUpperCase()).concat(e.slice(1).toLowerCase()):e.toLowerCase()})).join("")}var K=n(22),Q=n.n(K),Z=n(42),ee=n(70),te=n(71),ne=function(){function e(t){Object(ee.a)(this,e),this.axios=t}return Object(te.a)(e,[{key:"getTour",value:function(){var e=Object(Z.a)(Q.a.mark((function e(t){var n,o;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={context:this.resolveEventContext(t)},e.next=3,this.axios.post("tours",n);case 3:return o=e.sent,e.abrupt("return",o.data.tours[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"collectTourAction",value:function(){var e=Object(Z.a)(Q.a.mark((function e(t,n,o,i){var a,r;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.resolveEventContext(t),r={context:a},e.next=4,this.axios.post("tours/".concat(n,"/steps/").concat(o,"/actions/").concat(i),r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,o,i){return e.apply(this,arguments)}}()},{key:"resolveEventContext",value:function(e){var t,n;return U()({device:{locale:null!==(t=null===(n=document.querySelector("html"))||void 0===n?void 0:n.getAttribute("lang"))&&void 0!==t?t:void 0},page:{url:window.location.href},user:{anonymous:!0,id:""}},e)}}]),e}(),oe=Object(l.a)({productionPrefix:"enactive"}),ie=function(){var e=V(),t=i.a.useMemo((function(){if(void 0!==e){var t=d.a.create({baseURL:"https://".concat(e.apiHost,"/api/v1/sites/").concat(e.siteId)});return new ne(t)}}),[e]),n=i.a.useState(),o=Object(c.a)(n,2),a=o[0],r=o[1];return i.a.useEffect((function(){void 0!==t&&t.getTour(null===e||void 0===e?void 0:e.context).then(r)}),[e,t]),Object(O.jsx)(s.b,{generateClassName:oe,children:Object(O.jsx)(h,{children:void 0!==a?Object(O.jsx)(F,{onAction:function(n,o,i){return null===t||void 0===t?void 0:t.collectTourAction(null===e||void 0===e?void 0:e.context,a.id,n,i)},onComplete:function(){return r(void 0)},tour:a.steps}):Object(O.jsx)(O.Fragment,{})})})};n(166);r.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(ie,{})}),document.getElementById("enactive-app-root"))}},[[167,1,2]]]);
//# sourceMappingURL=main.a6d33f84.chunk.js.map