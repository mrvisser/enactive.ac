{"version":3,"sources":["components/theme/base.ts","components/theme/button.ts","components/ThemeContainer.tsx","components/Mask.tsx","components/Flex.tsx","components/Popper.tsx","components/Popup.tsx","components/TourStepPopup.tsx","components/TourSequence.tsx","util/nullishAssignment.ts","hooks/useEnactiveMetadata.ts","services/TourService.ts","App.tsx","index.tsx"],"names":["palette","contrastText","main","base","color","fontFamily","fontSize","buttonBase","alignContent","alignItems","borderRadius","cursor","display","flexDirection","justifyContent","lineHeight","margin","minWidth","overflow","padding","position","transition","zIndex","background","border","boxShadow","bottom","content","left","opacity","right","top","pointerEvents","buttonPrimary","button","ThemeContainer","styled","MaskInner","borderColor","borderStyle","Mask","active","children","onOutEnd","ref","style","maskRef","React","useRef","CSSTransition","in","onExited","nodeRef","timeout","el","current","Flex","FlexColumn","FlexRow","FlexContent","flex","Popper","anchorEl","offset","open","placement","divProps","useState","popperEl","setPopperEl","usePopper","modifiers","name","options","attributes","styles","popper","undefined","visibility","Content","Buttons","Systray","height","maxWidth","Inner","backgroundColor","TransitionSlideFade","transform","width","Popup","buttons","transitionRef","popperActive","setPopperActive","popperClosed","setPopperClosed","useEffect","length","TourStepPopup","html","onAction","onOut","targetEl","map","b","className","action","onClick","text","dangerouslySetInnerHTML","__html","TourSequence","onComplete","tour","stepIndex","setStepIndex","nextStepIndex","setNextStepIndex","window","scrollY","setScrollYPosition","stepInfos","useMemo","step","selector","type","document","querySelector","value","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","setTimeout","handler","addEventListener","removeEventListener","i","mask","rect","getBoundingClientRect","x","y","borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","filter","id","nullishAssignment","obj","key","compiled","Ajv","compile","properties","apiHost","context","nullable","device","locale","page","url","user","anonymous","siteId","useEnactiveMetadata","script","scriptData","params","URLSearchParams","attr","startsWith","append","substring","has","a","createElement","href","src","hostname","replace","sort","toString","encodeScriptDataFromAttributes","localStorageContext","setLocalStorageContext","scriptMetadata","setScriptMetadata","metadata","setMetadata","JSON","parse","localStorage","getItem","c","uuidv4","setItem","stringify","err","console","warn","data","result","entries","parseFlattenedKeys","init","last","level","part","errors","decodeScriptMetadataFromData","deepExtend","str","replaceAll","split","sausageToCamel","pop","w","toUpperCase","slice","toLowerCase","join","TourService","axios","eventContext","req","this","resolveEventContext","post","response","tours","tourId","stepId","getAttribute","location","classNameGenerator","createGenerateClassName","productionPrefix","App","tourService","axiosStatic","create","baseURL","setTour","getTour","then","StylesProvider","generateClassName","_","collectTourAction","steps","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.cb92e1c2.chunk.js","sourcesContent":["import { CSSProperties } from '@material-ui/styles';\n\nexport const palette = {\n  primary: {\n    contrastText: '#fff',\n    main: '#8d4a99',\n  },\n};\n\nexport const theme: CSSProperties = {\n  color: 'rgba(0, 0, 0, 0.87)',\n};\n\nexport const typography: CSSProperties = {\n  fontFamily: '\"Roboto\", \"Helvetica\", \"Arial\", sans-serif',\n  fontSize: 16,\n};\n\nexport const base: CSSProperties = {\n  ...theme,\n  ...typography,\n};\n","import { CSSProperties } from '@material-ui/styles';\n\nimport { base, palette } from './base';\n\nexport const buttonBase: Record<string, CSSProperties> = {\n  '& button': {\n    ...base,\n    /** Structural */\n    ...{\n      alignContent: 'center',\n      alignItems: 'center',\n      borderRadius: '0.4em',\n      cursor: 'pointer',\n      display: 'inline-flex',\n      flexDirection: 'row',\n      justifyContent: 'center',\n      lineHeight: '1.5em',\n      margin: 0,\n      minWidth: '5em',\n      overflow: 'hidden',\n      padding: '0.6em 0.8em',\n      position: 'relative',\n      transition: 'background 100ms linear',\n      zIndex: 1,\n    },\n    /** Reset */\n    background: 'rgba(0, 0, 0, 0)',\n    border: 'none',\n    boxShadow: 'none',\n  },\n  '& button::before': {\n    background: '#000',\n    bottom: 0,\n    content: '\"\"',\n    left: 0,\n    opacity: 0,\n    position: 'absolute',\n    right: 0,\n    top: 0,\n    zIndex: -1,\n  },\n  '& button:active::before, & button:hover::before, & button:focus::before': {\n    opacity: 0.07,\n  },\n  '& button:disabled': {\n    cursor: 'default',\n    opacity: 0.5,\n    pointerEvents: 'none',\n  },\n  '& div.enactive-buttongroup': {\n    margin: '-0.5em',\n  },\n  '& div.enactive-buttongroup button': {\n    margin: '0.5em',\n  },\n};\n\nexport const buttonContained: Record<string, CSSProperties> = {\n  '& button.enactive-contained': {\n    boxShadow:\n      '0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12)',\n  },\n  '& button.enactive-contained::before': {\n    opacity: 0.07,\n  },\n  '& button.enactive-contained:active::before, & button.enactive-contained:hover::before, & button.enactive-contained:focus::before':\n    {\n      opacity: 0,\n    },\n};\n\nexport const buttonPrimary: Record<string, CSSProperties> = {\n  '& button.enactive-primary': {\n    color: palette.primary.contrastText,\n  },\n  '& button.enactive-primary::before': {\n    background: palette.primary.main,\n    opacity: 1,\n  },\n  '& button.enactive-primary:active::before, & button.enactive-primary:hover::before, & button.enactive-primary:focus::before':\n    {\n      opacity: 0.85,\n    },\n};\n\nexport const button = {\n  ...buttonBase,\n  ...buttonContained,\n  ...buttonPrimary,\n};\n","import { styled } from '@material-ui/styles';\n\nimport { base } from './theme/base';\nimport { button } from './theme/button';\n\nexport const ThemeContainer = styled('div')({\n  ...base,\n  ...button,\n  '& p': {\n    ...base,\n    margin: '1em 0',\n  },\n});\n","import { styled } from '@material-ui/styles';\nimport React, { CSSProperties } from 'react';\nimport { CSSTransition } from 'react-transition-group';\n\nexport type MaskProps = {\n  active: boolean;\n  onOutEnd?: () => void;\n  ref?: React.RefCallback<HTMLElement>;\n  style?: CSSProperties;\n};\n\nconst MaskInner = styled('div')({\n  '&, &.enter, &.exit.exit-active, &.exit-done': {\n    opacity: 0,\n    pointerEvents: 'none',\n  },\n  '&.enter-active, &.exit-active': {\n    transition: 'opacity 250ms linear',\n  },\n  '&.enter.enter-active, &.enter-done, &.exit': {\n    opacity: 1,\n    pointerEvents: 'auto',\n  },\n  borderColor: 'rgba(0, 0, 0, 0.7)',\n  borderStyle: 'solid',\n  bottom: 0,\n  left: 0,\n  position: 'fixed',\n  right: 0,\n  top: 0,\n  zIndex: 1111,\n});\n\nexport const Mask: React.FC<MaskProps> = ({\n  active,\n  children,\n  onOutEnd = () => undefined,\n  ref,\n  style,\n}) => {\n  const maskRef = React.useRef<HTMLElement | null>(null);\n\n  return (\n    <CSSTransition\n      in={active}\n      onExited={onOutEnd}\n      nodeRef={maskRef}\n      timeout={250}\n    >\n      <MaskInner\n        ref={(el: HTMLElement | null) => {\n          maskRef.current = el;\n          ref?.(el);\n        }}\n        style={style}\n      >\n        {children}\n      </MaskInner>\n    </CSSTransition>\n  );\n};\n","import { styled } from '@material-ui/styles';\n\nexport const Flex = styled('div')({\n  display: 'flex',\n});\n\nexport const FlexColumn = styled(Flex)({\n  alignItems: 'stretch',\n  flexDirection: 'column',\n  justifyContent: 'flex-start',\n});\n\nexport const FlexRow = styled(Flex)({\n  alignItems: 'center',\n  justifyContent: 'center',\n});\n\nexport const FlexContent = styled('div')({\n  flex: 1,\n});\n\nexport const FlexItem = styled('div')({});\n","import { Placement } from '@popperjs/core';\nimport React from 'react';\nimport { usePopper } from 'react-popper';\n\nexport type PopperProps = React.HTMLAttributes<HTMLDivElement> & {\n  anchorEl?: HTMLElement;\n  offset?: number;\n  open: boolean;\n  placement?: Placement;\n};\n\nexport const Popper: React.FC<PopperProps> = ({\n  anchorEl,\n  children,\n  offset = 0,\n  open,\n  placement,\n  ...divProps\n}) => {\n  const [popperEl, setPopperEl] = React.useState<HTMLElement | null>(null);\n  const { attributes, styles } = usePopper(anchorEl, popperEl, {\n    modifiers: [{ name: 'offset', options: { offset: [0, offset] } }],\n    placement,\n  });\n\n  return (\n    <div\n      ref={setPopperEl}\n      {...divProps}\n      style={{\n        ...divProps.style,\n        ...styles.popper,\n        ...(!open\n          ? { pointerEvents: 'none', visibility: 'hidden' }\n          : undefined),\n      }}\n      {...attributes.popper}\n    >\n      {children}\n    </div>\n  );\n};\n","import { styled } from '@material-ui/styles';\nimport React from 'react';\nimport { ReactNode } from 'react';\nimport { CSSTransition } from 'react-transition-group';\n\nimport { FlexColumn, FlexContent, FlexRow } from './Flex';\nimport { Popper } from './Popper';\n\nexport type PopupProps = {\n  anchorEl?: HTMLElement;\n  buttons?: ReactNode[];\n  onOutEnd?: () => void;\n  open: boolean;\n};\n\nconst Content = styled(FlexContent)({\n  minWidth: '20em',\n  padding: '1em',\n});\n\nconst Buttons = styled(FlexRow)({\n  '& > button': {\n    margin: '0.25em',\n  },\n  justifyContent: 'flex-end',\n  margin: '-0.25em',\n  padding: '1em',\n});\n\nconst Systray = styled('div')({\n  bottom: '2em',\n  height: 'auto',\n  maxWidth: '35em',\n  position: 'fixed',\n  right: '2em',\n});\n\nconst Inner = styled(FlexColumn)({\n  backgroundColor: 'white',\n  borderRadius: '1em',\n  position: 'relative',\n});\n\nconst TransitionSlideFade = styled('div')({\n  '&, &.enter, &.exit.exit-active, &.exit-done': {\n    opacity: 0,\n    top: '2em',\n  },\n  '&.enter-active, &.exit-active': {\n    transition: 'opacity 250ms ease-in, top 250ms ease-in',\n  },\n  '&.enter.enter-active, &.enter-done, &.exit': {\n    opacity: 1,\n    top: 0,\n  },\n  '[data-popper-placement=\"bottom\"] &::before': {\n    left: 'calc(50% - 0.5em)',\n    top: '-0.5em',\n  },\n  '[data-popper-placement=\"left\"] &::before': {\n    right: '-0.5em',\n    top: 'calc(50% - 0.5em)',\n  },\n  '[data-popper-placement=\"right\"] &::before': {\n    left: '-0.5em',\n    top: 'calc(50% - 0.5em)',\n  },\n  '[data-popper-placement=\"top\"] &::before': {\n    bottom: '-0.5em',\n    left: 'calc(50% - 0.5em)',\n  },\n  '[data-popper-placement] &::before': {\n    backgroundColor: 'white',\n    boxShadow:\n      '0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 5px 8px 0px rgba(0, 0, 0, 0.14), 0px 1px 14px 0px rgba(0, 0, 0, 0.12)',\n    content: '\"\"',\n    display: 'block',\n    height: '1em',\n    position: 'absolute',\n    transform: 'rotate(45deg)',\n    width: '1em',\n  },\n  borderRadius: '1em',\n  boxShadow:\n    '0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 5px 8px 0px rgba(0, 0, 0, 0.14), 0px 1px 14px 0px rgba(0, 0, 0, 0.12)',\n  position: 'relative',\n});\nexport const Popup: React.FC<PopupProps> = ({\n  anchorEl,\n  buttons = [],\n  children,\n  onOutEnd = () => undefined,\n  open,\n}) => {\n  const transitionRef = React.useRef(null);\n  const [popperActive, setPopperActive] = React.useState(open);\n  const [popperClosed, setPopperClosed] = React.useState(false);\n\n  React.useEffect(() => {\n    if (open && !popperActive && !popperClosed) {\n      setPopperActive(true);\n    } else if (popperClosed) {\n      setPopperActive(false);\n      setPopperClosed(false);\n    }\n  }, [open, popperActive, popperClosed]);\n\n  return anchorEl !== undefined ? (\n    <Popper\n      anchorEl={anchorEl}\n      offset={12}\n      open={popperActive}\n      placement=\"right\"\n      style={{ maxWidth: '35em', zIndex: 1112 }}\n    >\n      <CSSTransition\n        onExited={() => {\n          setPopperClosed(true);\n          onOutEnd();\n        }}\n        in={open}\n        nodeRef={transitionRef}\n        timeout={250}\n      >\n        <TransitionSlideFade ref={transitionRef}>\n          <Inner>\n            <Content>{children}</Content>\n            {buttons.length > 0 ? <Buttons>{buttons}</Buttons> : undefined}\n          </Inner>\n        </TransitionSlideFade>\n      </CSSTransition>\n    </Popper>\n  ) : (\n    <Systray\n      style={{\n        zIndex: 1112,\n        ...(!open ? { pointerEvents: 'none' } : undefined),\n      }}\n    >\n      <CSSTransition\n        onExited={() => {\n          setPopperClosed(true);\n          onOutEnd();\n        }}\n        in={open}\n        nodeRef={transitionRef}\n        timeout={250}\n      >\n        <TransitionSlideFade ref={transitionRef}>\n          <Inner>\n            <Content>{children}</Content>\n            {buttons.length > 0 ? <Buttons>{buttons}</Buttons> : undefined}\n          </Inner>\n        </TransitionSlideFade>\n      </CSSTransition>\n    </Systray>\n  );\n};\n","import React from 'react';\n\nimport { TourStepButton } from '../../../api/src/domain/TourStepButton';\nimport { Popup } from './Popup';\n\nexport type TourStepPopupProps = {\n  active: boolean;\n  buttons: TourStepButton[];\n  html: string;\n  onAction: (action: TourStepButton['action']) => void;\n  onOut?: () => void;\n  targetEl?: HTMLElement;\n};\n\nexport const TourStepPopup: React.FC<TourStepPopupProps> = ({\n  active,\n  buttons,\n  html,\n  onAction,\n  onOut = () => undefined,\n  targetEl,\n}) => {\n  return (\n    <Popup\n      anchorEl={targetEl}\n      buttons={buttons.map((b) => [\n        <button\n          className={`${b.action === 'next' ? 'enactive-primary' : ''}`}\n          key={b.action}\n          onClick={() => onAction(b.action)}\n        >\n          {b.text}\n        </button>,\n      ])}\n      open={active}\n      onOutEnd={onOut}\n    >\n      <div dangerouslySetInnerHTML={{ __html: html }} />\n    </Popup>\n  );\n};\n","import React from 'react';\n\nimport { TourStep } from '../../../api/src/domain/TourStep';\nimport { TourStepButton } from '../../../api/src/domain/TourStepButton';\nimport { Mask } from './Mask';\nimport { TourStepPopup } from './TourStepPopup';\n\nexport type TourSequenceProps = {\n  onAction: (\n    stepId: string,\n    stepIndex: number,\n    action: TourStepButton['action'],\n  ) => void;\n  onComplete: () => void;\n  tour: TourStep[];\n};\n\nexport const TourSequence: React.FC<TourSequenceProps> = ({\n  onAction,\n  onComplete,\n  tour,\n}) => {\n  const [stepIndex, setStepIndex] = React.useState<number>(-1);\n  const [nextStepIndex, setNextStepIndex] = React.useState<number>();\n\n  /** This is just here so we can trigger a render on scroll... there must be a better way. */\n  const [, setScrollYPosition] = React.useState<number>(window.scrollY);\n\n  const stepInfos = React.useMemo(() => {\n    return tour.map((step) => ({\n      step,\n      targetEl:\n        ((): HTMLElement | null => {\n          switch (step.selector?.type) {\n            case 'css':\n              return document.querySelector<HTMLElement>(step.selector.value);\n            case 'xpath':\n              return document.evaluate(\n                step.selector.value,\n                document,\n                null,\n                XPathResult.FIRST_ORDERED_NODE_TYPE,\n                null,\n              ).singleNodeValue as HTMLElement | null;\n            case undefined:\n              return null;\n          }\n        })() ?? undefined,\n    }));\n  }, [tour]);\n\n  React.useEffect(() => {\n    setTimeout(() => setStepIndex(0), 1000);\n\n    const handler = () => setScrollYPosition(window.scrollY);\n    window.addEventListener('scroll', handler);\n    return () => window.removeEventListener('scroll', handler);\n  }, []);\n\n  return (\n    <>\n      {stepInfos.map(({ step, targetEl }, i) => {\n        return (\n          <div key={i}>\n            {step.mask ? (\n              <Mask\n                active={\n                  nextStepIndex !== -1 &&\n                  ((stepIndex === i && nextStepIndex === undefined) ||\n                    nextStepIndex === i)\n                }\n                key={`mask-${i}`}\n                style={(() => {\n                  const rect = targetEl?.getBoundingClientRect();\n                  const x = rect?.x ?? 0;\n                  const y = rect?.y ?? 0;\n                  const width = rect?.width ?? 0;\n                  const height = rect?.height ?? 0;\n                  const borderBottomWidth = `calc(100vh - ${y + height}px)`;\n                  return {\n                    borderBottomWidth,\n                    borderLeftWidth: rect?.x,\n                    borderRightWidth: `calc(100vw - ${x + width}px)`,\n                    borderTopWidth: rect?.y,\n                  };\n                })()}\n              />\n            ) : undefined}\n            <TourStepPopup\n              active={nextStepIndex === undefined && stepIndex === i}\n              buttons={\n                step.buttons ??\n                [\n                  { action: 'dismiss', text: 'Dismiss' },\n                  i < tour.length - 1\n                    ? { action: 'next', text: 'Next' }\n                    : undefined,\n                ].filter((b): b is TourStepButton => b !== undefined)\n              }\n              html={step.html}\n              key={`popup-${i}`}\n              onAction={(action) => {\n                onAction(step.id, i, action);\n                switch (action) {\n                  case 'dismiss':\n                    return setNextStepIndex(-1);\n                  case 'next':\n                    return setNextStepIndex(i + 1);\n                }\n              }}\n              onOut={() => {\n                if (nextStepIndex === -1) {\n                  onComplete();\n                } else if (nextStepIndex !== undefined) {\n                  setStepIndex(nextStepIndex);\n                  setNextStepIndex(undefined);\n                }\n              }}\n              targetEl={targetEl}\n            />\n          </div>\n        );\n      })}\n    </>\n  );\n};\n","/**\n * Temporary replacement for `??=` which doesn't work in CRA right now.\n * https://github.com/facebook/create-react-app/issues/10734\n */\nexport function nullishAssignment<T extends Record<string, unknown>>(\n  obj: T,\n  key: keyof T,\n  value: T[typeof key],\n): void {\n  if (obj[key] === undefined || obj[key] === null) {\n    obj[key] = value;\n  }\n}\n","/* eslint-disable no-console */\nimport Ajv from 'ajv';\nimport deepExtend from 'deep-extend';\nimport React from 'react';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { EventContext } from '../../../api/src/domain/EventContext';\nimport { RecursivePartial } from '../util/RecursivePartial';\nimport { nullishAssignment } from '../util/nullishAssignment';\n\nexport type EnactiveMetadata = {\n  apiHost: string;\n  context?: RecursivePartial<EventContext>;\n  siteId: string;\n};\n\n// This JSONSchemaType really slows down the compiler. But uncomment if making changes\nconst metadataSchema /*: JSONSchemaType<EnactiveScriptMetadata>*/ = {\n  properties: {\n    apiHost: {\n      type: 'string',\n    },\n    context: {\n      nullable: true,\n      properties: {\n        device: {\n          nullable: true,\n          properties: {\n            locale: {\n              nullable: true,\n              type: 'string',\n            },\n          },\n          type: 'object',\n        },\n        page: {\n          nullable: true,\n          properties: {\n            locale: {\n              nullable: true,\n              type: 'string',\n            },\n            url: {\n              nullable: true,\n              type: 'string',\n            },\n          },\n          type: 'object',\n        },\n        user: {\n          nullable: true,\n          properties: {\n            anonymous: {\n              nullable: true,\n              type: 'boolean',\n            },\n            id: {\n              nullable: true,\n              type: 'string',\n            },\n            locale: {\n              nullable: true,\n              type: 'string',\n            },\n          },\n          type: 'object',\n        },\n      },\n      type: 'object',\n    },\n    siteId: {\n      type: 'string',\n    },\n  },\n  type: 'object',\n};\nconst compiled = new Ajv().compile<EnactiveMetadata>(metadataSchema);\n\nconst selector = 'script[enactive\\\\.site-id]';\n\nexport const useEnactiveMetadata = (): EnactiveMetadata | undefined => {\n  const script = React.useMemo(() => {\n    return document.querySelector<HTMLScriptElement>(selector) ?? undefined;\n  }, []);\n  const scriptData = React.useMemo(\n    () => encodeScriptDataFromAttributes(script),\n    [script],\n  );\n\n  const [localStorageContext, setLocalStorageContext] =\n    React.useState<RecursivePartial<EventContext>>();\n  const [scriptMetadata, setScriptMetadata] =\n    React.useState<EnactiveMetadata>();\n  const [metadata, setMetadata] = React.useState<EnactiveMetadata>();\n\n  React.useEffect(() => {\n    const context = (() => {\n      try {\n        return (\n          (JSON.parse(\n            localStorage.getItem('enactive-context') ?? 'null',\n          ) as RecursivePartial<EventContext> | null) ?? undefined\n        );\n      } catch {}\n    })();\n\n    if (context === undefined) {\n      // Create a user id for local storage that will help track the user in a somewhat stable\n      // way and remember tours that they have dismissed server-side\n      const c: RecursivePartial<EventContext> = {\n        user: {\n          anonymous: true,\n          id: uuidv4(),\n        },\n      };\n      setLocalStorageContext(c);\n\n      try {\n        localStorage.setItem('enactive-context', JSON.stringify(c));\n      } catch (err) {\n        console.warn('Failed to set enactive device data in storage.', err);\n      }\n    } else {\n      setLocalStorageContext(context);\n    }\n  }, []);\n\n  React.useEffect(\n    () =>\n      setScriptMetadata(\n        decodeScriptMetadataFromData(scriptData, { script, selector }),\n      ),\n    [scriptData, script],\n  );\n\n  React.useEffect(() => {\n    if (localStorageContext !== undefined && scriptMetadata !== undefined) {\n      setMetadata(\n        deepExtend({}, { context: localStorageContext }, scriptMetadata),\n      );\n    } else {\n      setMetadata(undefined);\n    }\n  }, [scriptMetadata, localStorageContext]);\n\n  return metadata;\n};\n\nfunction encodeScriptDataFromAttributes(\n  script: HTMLScriptElement | undefined,\n): string {\n  if (script !== undefined) {\n    const params = new URLSearchParams();\n    for (const attr of script.attributes) {\n      if (attr.name.startsWith('enactive.') === true) {\n        params.append(attr.name.substring(9), attr.value);\n      }\n    }\n\n    if (params.has('api-host') === false) {\n      const a = document.createElement('a');\n      a.href = script.src;\n      params.append('api-host', `api.${a.hostname.replace('www.', '')}`);\n    }\n\n    params.sort();\n    return params.toString();\n  } else {\n    return '';\n  }\n}\n\nfunction decodeScriptMetadataFromData(\n  data: string | undefined,\n  { selector = '', script = undefined as HTMLScriptElement | undefined } = {},\n): EnactiveMetadata | undefined {\n  if (data === undefined) {\n    console.warn('Could not locate enactive script tag with metadata', {\n      script,\n      selector,\n    });\n    return undefined;\n  }\n\n  const result: Record<string, unknown> = {};\n  const params = new URLSearchParams(data).entries();\n  for (const [key, value] of params) {\n    const [init, last] = parseFlattenedKeys(key);\n    let level = result;\n    for (const part of init) {\n      if (part in level && typeof level[part] !== 'object') {\n        console.warn(\n          'Assigned both a value and an object on enactive script tag metadata',\n          { script, selector },\n        );\n      }\n\n      if (part in level) {\n        level = level[part] as Record<string, unknown>;\n      } else {\n        level = level[part] = {};\n      }\n    }\n\n    if (last in level) {\n      console.warn(\n        'Assigned duplicate values on enactive script tag metadata',\n        { script, selector },\n      );\n    }\n    level[last] = value;\n  }\n\n  if (compiled(result)) {\n    // If a user id was set and anonymous was not explicitly set, we treat it as non-anonymous\n    if (result.context?.user?.id !== undefined) {\n      nullishAssignment(result.context.user, 'anonymous', false);\n    }\n\n    return result;\n  } else {\n    console.warn('Invalid enactive script tag metadata', {\n      errors: compiled.errors,\n      result,\n      script,\n      selector,\n    });\n  }\n}\n\nfunction parseFlattenedKeys(key: string): [string[], string] {\n  const init = splitDot(key).map(sausageToCamel);\n  const last = init.pop() ?? '';\n  return [init, last];\n}\n\nfunction splitDot(str: string): string[] {\n  return (\n    str\n      // Trim dots\n      .replaceAll(/^\\.+|\\.+$/g, '')\n      // Reduce multiple dots\n      .replaceAll(/\\.+/g, '.')\n      .split('.')\n  );\n}\n\nfunction sausageToCamel(str: string): string {\n  // Convert sausage-case-keys to camelCaseKeys\n  return (\n    str\n      // Trim dashes\n      .replaceAll(/^-+|-+$/g, '')\n      // De-duplicate successive dashes\n      .replaceAll(/-+/g, '-')\n      .split('-')\n      .map((w, i) =>\n        i > 0 && w.length > 0\n          ? `${w[0].toUpperCase()}${w.slice(1).toLowerCase()}`\n          : w.toLowerCase(),\n      )\n      .join('')\n  );\n}\n","import { AxiosInstance } from 'axios';\nimport deepExtend from 'deep-extend';\nimport React from 'react';\n\nimport { EventContext } from '../../../api/src/domain/EventContext';\nimport {\n  FindToursRequest,\n  FindToursResponse,\n} from '../../../api/src/domain/FindTours';\nimport { PostTourActionRequest } from '../../../api/src/domain/PostTourAction';\nimport { Tour } from '../../../api/src/domain/Tour';\nimport { TourStepButton } from '../../../api/src/domain/TourStepButton';\nimport { RecursivePartial } from '../util/RecursivePartial';\n\nexport class TourService {\n  constructor(private readonly axios: AxiosInstance) {}\n\n  public async getTour(\n    eventContext: RecursivePartial<EventContext> | undefined,\n  ): Promise<Tour | undefined> {\n    const req: FindToursRequest = {\n      context: this.resolveEventContext(eventContext),\n    };\n\n    const response = await this.axios.post<FindToursResponse>('tours', req);\n    return response.data.tours[0];\n  }\n\n  public async collectTourAction(\n    eventContext: RecursivePartial<EventContext> | undefined,\n    tourId: string,\n    stepId: string,\n    action: TourStepButton['action'],\n  ): Promise<void> {\n    const context = this.resolveEventContext(eventContext);\n    const req: PostTourActionRequest = { context };\n    await this.axios.post(\n      `tours/${tourId}/steps/${stepId}/actions/${action}`,\n      req,\n    );\n  }\n\n  private resolveEventContext(\n    context: RecursivePartial<EventContext> | undefined,\n  ): EventContext {\n    return deepExtend(\n      {\n        device: {\n          locale:\n            document.querySelector('html')?.getAttribute('lang') ?? undefined,\n        },\n        page: {\n          url: window.location.href,\n        },\n        user: {\n          anonymous: true,\n          id: '',\n        },\n      },\n      context,\n    );\n  }\n}\n\nexport const TourServiceContext = React.createContext<TourService>(\n  null as unknown as TourService,\n);\n","import { createGenerateClassName, StylesProvider } from '@material-ui/styles';\nimport axiosStatic from 'axios';\nimport React from 'react';\n\nimport { Tour } from '../../api/src/domain/Tour';\nimport { ThemeContainer } from './components/ThemeContainer';\nimport { TourSequence } from './components/TourSequence';\nimport { useEnactiveMetadata } from './hooks/useEnactiveMetadata';\nimport { TourService } from './services/TourService';\n\nconst classNameGenerator = createGenerateClassName({\n  productionPrefix: 'enactive',\n});\n\nconst App: React.FC = () => {\n  const metadata = useEnactiveMetadata();\n  const tourService = React.useMemo(() => {\n    if (metadata !== undefined) {\n      const axios = axiosStatic.create({\n        baseURL: `https://${metadata.apiHost}/api/v1/sites/${metadata.siteId}`,\n      });\n      return new TourService(axios);\n    }\n  }, [metadata]);\n  const [tour, setTour] = React.useState<Tour>();\n  React.useEffect(() => {\n    if (tourService !== undefined) {\n      void tourService.getTour(metadata?.context).then(setTour);\n    }\n  }, [metadata, tourService]);\n  return (\n    <StylesProvider generateClassName={classNameGenerator}>\n      <ThemeContainer>\n        {tour !== undefined ? (\n          <TourSequence\n            onAction={(stepId, _, action) =>\n              tourService?.collectTourAction(\n                metadata?.context,\n                tour.id,\n                stepId,\n                action,\n              )\n            }\n            onComplete={() => setTour(undefined)}\n            tour={tour.steps}\n          />\n        ) : (\n          <></>\n        )}\n      </ThemeContainer>\n    </StylesProvider>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nimport 'typeface-roboto';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('enactive-app-root'),\n);\n"],"sourceRoot":""}