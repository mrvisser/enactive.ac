(this["webpackJsonpenactive-integration-ui"]=this["webpackJsonpenactive-integration-ui"]||[]).push([[0],{321:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(59),c=n.n(r),s=n(381),o=n(382),u=n(65),l=n(12),d=n(5),j=n(407),h=n(403),b=n(398),p=n(411),x=n(412),O=n(394),m=n(168),f=n.n(m),v=n(22);function g(e,t,n){var a=i.a.useState(n),r=Object(l.a)(a,2),c=r[0],s=r[1],o=i.a.useCallback(e,t);return i.a.useEffect((function(){var e=o();if(void 0!==e){var t=e.subscribe(s);return function(){return t.unsubscribe()}}}),[o]),[c]}var y=n(14),w=n(19),S=n.n(w),C=n(30),k=n(16),$=n(17),E=n(121),I=n.n(E),R=n(384),T=function(){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I.a.create({baseURL:"".concat(null!==(t=new URLSearchParams(window.location.search.slice(1)).get("_devHost"))&&void 0!==t?t:"https://api.".concat(window.location.hostname.replace("www.","")),"/api/v1/")});Object(k.a)(this,e),this.axiosBase=n,this.axios=void 0,this.account$$=new R.a(void 0),this.sites$$=new R.a(void 0),this.tours$$=new R.a(void 0),this.account$=this.account$$.asObservable(),this.sites$=this.sites$$.asObservable(),this.tours$=this.tours$$.asObservable(),this.axios=n}return Object($.a)(e,[{key:"signOut",value:function(){var e=Object(C.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.tours$$.next(void 0),this.sites$$.next(void 0),this.account$$.next(void 0),this.axios=this.axiosBase;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signUp",value:function(){var e=Object(C.a)(S.a.mark((function e(t){var n,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.axiosBase.post("management/signup",{email:t,id:""});case 2:return n=e.sent,a=n.data,this.account$$.next(a),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"authenticate",value:function(){var e=Object(C.a)(S.a.mark((function e(t,n){var a,i,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=I.a.create(Object(y.a)(Object(y.a)({},this.axiosBase.defaults),{},{headers:Object(y.a)(Object(y.a)({},this.axiosBase.defaults.headers),{},{Authorization:"Basic ".concat(window.btoa("".concat(t,":").concat(n)))})})),e.next=3,a.get("management/me");case 3:return i=e.sent,r=i.data.account,this.account$$.next(r),this.axios=a,e.next=9,this.loadSites(r);case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadTours",value:function(){var e=Object(C.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.axios.get("management/sites/".concat(t,"/tours"));case 2:return n=e.sent,this.tours$$.next(n.data.tours),e.abrupt("return",n.data.tours);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createTour",value:function(){var e=Object(C.a)(S.a.mark((function e(t,n){var a,i,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.axios.post("management/sites/".concat(t,"/tours"),n);case 2:return a=e.sent,i=a.data.tour,r=this.tours$$.value,this.tours$$.next(void 0===r?[i]:r.concat([i])),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTour",value:function(){var e=Object(C.a)(S.a.mark((function e(t,n,a){var i,r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.axios.put("management/sites/".concat(t,"/tours/").concat(n),a);case 2:return i=e.sent,r=i.data.tour,c=this.tours$$.value,this.tours$$.next(void 0===c?[r]:c.map((function(e){return e.id===r.id?r:e}))),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"loadSites",value:function(){var e=Object(C.a)(S.a.mark((function e(t){var n,a,i;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.axios.get("management/sites");case 2:if(n=e.sent,0!==(a=n.data.sites).length){e.next=9;break}return e.next=7,this.createSite({domain:t.email,id:""});case 7:i=e.sent,a.push(i);case 9:return this.sites$$.next(a),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSite",value:function(){var e=Object(C.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.axios.post("management/sites",t);case 2:return n=e.sent,e.abrupt("return",n.data.site);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),z=n(383),F=n(395),q=n(366),P=n(389),W=n(387),M=n(1),U=function(e){var t=e.account,n=e.buttonProps,a=e.onSignOut,r=i.a.useRef(null),c=i.a.useState(!1),s=Object(l.a)(c,2),o=s[0],u=s[1];return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(O.a,Object(y.a)(Object(y.a)({color:"inherit"},n),{},{onClick:function(e){var t;u(!0),null===n||void 0===n||null===(t=n.onClick)||void 0===t||t.call(n,e)},ref:r,children:t.email})),Object(M.jsx)(z.a,{anchorEl:r.current,disablePortal:!0,open:o,children:Object(M.jsx)(F.a,{children:Object(M.jsx)(q.a,{onClickAway:function(){return u(!1)},children:Object(M.jsx)(P.a,{children:Object(M.jsx)(W.a,{children:Object(M.jsx)(O.a,{onClick:function(){return a()},children:"Sign Out"})})})})})})]})},A=n(408),B=n(409),D=n(393),G=n(379),N=n(63),V=function(e){var t=e.disabled,n=void 0!==t&&t,r=e.key,c=Object(N.a)(e,["disabled","key"]),s=i.a.useMemo((function(){return void 0!==r||n?void 0===r?"disabled":n?"".concat(r,"-disabled"):r:void 0}),[n,r]);return Object(a.createElement)(O.a,Object(y.a)(Object(y.a)({},c),{},{disabled:n,key:s}))},X=n(3),L=n(404),_=n(28),H=n(397),J=n(396),Y=n(402),K=n(388),Q=n(405),Z=n(392),ee=n(406),te=n(372),ne=n(373),ae=n(374),ie=n(375),re=n(376),ce=n(377),se=n(378),oe=n(21),ue=n(50),le=n(60);le.addMethod(le.string,"validRegex",(function(){return this.test("test-valid-regex",(function(e){if(void 0===e)return!0;var t=this.path,n=this.createError;try{return new RegExp(e),!0}catch(a){return n({message:a.message,path:t})}}))})),le.addMethod(le.string,"validCssSelector",(function(){return this.test("test-valid-css-selector",(function(e){if(void 0===e||""===e)return!0;var t=this.path,n=this.createError;try{return document.querySelector(e),!0}catch(a){return n({message:"Invalid CSS selector",path:t})}}))})),le.addMethod(le.string,"validXpathSelector",(function(){return this.test("test-valid-xpath-selector",(function(e){if(void 0===e||""===e)return!0;var t=this.path,n=this.createError;try{return document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null),!0}catch(a){return n({message:"Invalid XPath selector",path:t})}}))}));var de=le,je=n(391),he=n(399),be=n(400),pe=n(401),xe=n(371),Oe=Object(d.a)(je.a)((function(e){return{alignItems:"center",display:"flex",justifyContent:"space-between",marginBottom:e.theme.spacing(4)}})),me=Object(d.a)(he.a)({padding:"3em"}),fe=Object(d.a)(be.a)((function(e){var t=e.theme;return{backgroundColor:t.palette.grey[50],borderTop:"solid 1px",borderTopColor:t.palette.grey[200],padding:t.spacing(4)}})),ve=function(e){var t=e.actions,n=e.children,a=e.onClose,i=e.onExited,r=e.open,c=e.title,s=e.width,o=void 0===s?"35rem":s;return Object(M.jsxs)(pe.a,{anchor:"right",open:r,onClose:a,SlideProps:{onExited:i},children:[Object(M.jsxs)(Oe,{children:[Object(M.jsx)(b.a,{component:"span",variant:"h5",style:{flexGrow:1},children:c}),void 0!==a?Object(M.jsx)(Y.a,{onClick:a,children:Object(M.jsx)(xe.a,{})}):void 0]}),Object(M.jsx)(me,{sx:{width:o},children:n}),Object(M.jsx)(fe,{children:t})]})},ge=Object(d.a)(h.a)({alignItems:"center",display:"flex",maxWidth:"35em"}),ye=Object(d.a)(h.a)((function(e){e.fontSize;var t=e.theme;return{"& svg":{height:t.typography.h1.fontSize,opacity:.3,width:t.typography.h1.fontSize},marginRight:t.spacing(2)}})),we=Object(d.a)(h.a)({alignSelf:"stretch",display:"flex",flexDirection:"column",flexGrow:1}),Se=Object(d.a)(h.a)((function(e){var t=e.theme;return{flexGrow:1,padding:"".concat(t.spacing(2)," 0")}})),Ce=Object(d.a)(h.a)({alignItems:"center",display:"flex",justifyContent:"flex-end"}),ke=function(e){var t=e.actionsComponent,n=e.children,a=e.illustrationComponent,i=Object(N.a)(e,["actionsComponent","children","illustrationComponent"]);return Object(M.jsxs)(ge,Object(y.a)(Object(y.a)({},i),{},{children:[Object(M.jsx)(ye,{children:a}),Object(M.jsxs)(we,{children:[Object(M.jsx)(Se,{children:n}),void 0!==t?Object(M.jsx)(Ce,{children:t}):void 0]})]}))},$e=function(e){e.alignItems;var t=e.col,n=void 0!==t&&t,a=Object(N.a)(e,["alignItems","col"]);return Object(M.jsx)(h.a,Object(y.a)(Object(y.a)({},a),{},{sx:Object(y.a)(Object(y.a)({},a.sx),{},{display:"flex",flexDirection:n?"column":"row"})}))},Ee=function(e){var t=e.grow,n=void 0!==t&&t,a=Object(N.a)(e,["grow"]);return Object(M.jsx)(h.a,Object(y.a)(Object(y.a)({},a),{},{sx:Object(y.a)(Object(y.a)({},a.sx),{},{flexGrow:n?1:void 0})}))},Ie=Object(d.a)(Ee)((function(e){return{margin:e.theme.spacing(.5)}})),Re=Object(d.a)(L.a)((function(e){return{"& > div.MuiAccordionSummary-content":{marginRight:e.theme.spacing(2),minWidth:0}}})),Te=de.object().shape({type:de.mixed().oneOf(["css","xpath"]).default("css"),value:de.string().when("type",{is:"xpath",otherwise:de.string().validCssSelector(),then:de.string().validXpathSelector()}).default("")}),ze=de.object().shape({html:de.string().required("Message is required"),mask:de.boolean().required(),selector:Te.notRequired()}),Fe=de.object().shape({match:de.object().shape({regex:de.string().required("URL match expression is required").validRegex()}),name:de.string().required("Name is required"),status:de.mixed().oneOf(["draft","published"]).default("draft"),steps:de.array().of(ze)}),qe=function(e){var t=e.managementService,n=e.onClose,a=void 0===n?function(){}:n,r=e.onExited,c=void 0===r?function(){}:r,s=e.onSave,o=void 0===s?function(){}:s,u=e.open,d=e.siteId,j=e.tour,p=Object(_.a)(),x=i.a.useRef(null),O=i.a.useState((function(){return We(j)})),m=Object(l.a)(O,2),f=m[0],v=m[1],g=i.a.useState({}),w=Object(l.a)(g,2),k=w[0],$=w[1];function E(e,t){$((function(t){return Object(X.a)({},e.values.steps.length,!0)})),t.push(Me())}return i.a.useEffect((function(){v(We(j)),$({})}),[j]),Object(M.jsx)(ve,{actions:Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(V,{onClick:function(){return a()},size:"large",children:"Cancel"}),Object(M.jsx)(V,{color:"primary",onClick:function(){null!==x.current&&x.current.submitForm()},size:"large",variant:"contained",children:""===(null===f||void 0===f?void 0:f.id)?"Create":"Save"})]}),onClose:a,onExited:c,open:u,title:""===(null===f||void 0===f?void 0:f.id)?"Create tour":"Edit tour",children:Object(M.jsx)(oe.d,{initialValues:f,innerRef:x,onSubmit:function(){var e=Object(C.a)(S.a.mark((function e(n,a){var i,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setSubmitting(!0),i=Object(y.a)(Object(y.a)({},n),{},{steps:n.steps.map((function(e){return Object(y.a)(Object(y.a)({},e),{},{selector:void 0!==e.selector&&""===e.selector.value.trim()?void 0:e.selector})}))}),e.next=4,""===i.id?t.createTour(d,i):t.updateTour(d,i.id,i);case 4:r=e.sent,a.setSubmitting(!1),o(r);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),validateOnChange:!1,validationSchema:Fe,children:function(e){return Object(M.jsxs)(oe.c,{children:[Object(M.jsx)($e,{justifyContent:"flex-end",mb:2,children:Object(M.jsx)(H.a,{control:Object(M.jsx)(J.a,{color:"success",checked:"published"===e.values.status,onChange:function(){e.setFieldValue("status","published"===e.values.status?"draft":"published")}}),label:"Published",labelPlacement:"start"})}),Object(M.jsx)(b.a,{mb:.75,component:"h2",variant:"subtitle1",children:"Profile"}),Object(M.jsx)(oe.a,{component:ue.a,fullWidth:!0,label:"Name",name:"name",placeholder:"New account orientation",size:"medium",validate:!0,variant:"outlined"}),Object(M.jsx)(b.a,{mb:.75,mt:2.5,component:"h2",variant:"subtitle1",children:"Criteria"}),Object(M.jsx)(oe.a,{component:ue.a,fullWidth:!0,helperText:"Enter a valid regular expression",label:"URL match expression",name:"match.regex",placeholder:"/dashboard/?",size:"medium",validate:!0,variant:"outlined"}),Object(M.jsx)(oe.b,{name:"steps",children:function(t){return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(b.a,{mb:.75,mt:2.5,component:"h2",variant:"subtitle1",children:Object(M.jsxs)($e,{children:[Object(M.jsx)(Ee,{grow:!0,children:"Steps"}),Object(M.jsx)(Ee,{children:Object(M.jsx)(Y.a,{color:"primary",onClick:function(){return E(e,t)},children:Object(M.jsx)(te.a,{})})})]})}),0===e.values.steps.length?Object(M.jsx)($e,{justifyContent:"center",width:"100%",children:Object(M.jsx)(ke,{actionsComponent:Object(M.jsx)(V,{color:"primary",onClick:function(){return E(e,t)},variant:"contained",children:"Create Step"}),illustrationComponent:Object(M.jsx)(ne.a,{style:{height:p.typography.h2.fontSize,width:p.typography.h2.fontSize}}),mt:2,style:{maxWidth:"30rem"},children:"A tour step is one of several interactive message dialogs that are shown to your users in the context that you want them to show."})}):Object(M.jsx)(h.a,{sx:{width:"100%"},children:e.values.steps.map((function(n,a){var i,r,c;return Object(M.jsxs)(K.a,{expanded:null!==(i=k[a])&&void 0!==i&&i,children:[Object(M.jsxs)(Re,{expandIcon:Object(M.jsx)(ae.a,{}),onClick:function(){return $((function(e){return Object(y.a)(Object(y.a)({},e),{},Object(X.a)({},a,!e[a]))}))},children:[Object(M.jsx)(Ee,{width:"2rem",mr:1,children:Object(M.jsxs)(b.a,{variant:"body1",component:"h3",children:[a+1,"."]})}),Object(M.jsx)(Ee,{flex:"1",minWidth:"0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:Object(M.jsx)(b.a,{variant:"body2",sx:{display:"inline",opacity:.875},children:""===n.html.trim()?"No content":n.html})}),Pe(e.errors,a)?Object(M.jsx)(Ee,{color:"error.main",mr:1,sx:{alignItems:"center",display:"flex"},children:Object(M.jsx)(ie.a,{})}):void 0]}),Object(M.jsxs)(Q.a,{children:[Object(M.jsxs)($e,{justifyContent:"flex-end",children:[Object(M.jsx)(Y.a,{disabled:0===a,onClick:function(){$((function(e){var t;return Object(y.a)(Object(y.a)({},e),{},(t={},Object(X.a)(t,a-1,e[a]),Object(X.a)(t,a,e[a-1]),t))})),t.swap(a-1,a)},title:"Move up",children:Object(M.jsx)(re.a,{})}),Object(M.jsx)(Y.a,{disabled:a===e.values.steps.length-1,onClick:function(){$((function(e){var t;return Object(y.a)(Object(y.a)({},e),{},(t={},Object(X.a)(t,a+1,e[a]),Object(X.a)(t,a,e[a+1]),t))})),t.swap(a,a+1)},title:"Move down",children:Object(M.jsx)(ce.a,{})}),Object(M.jsx)(h.a,{ml:2,children:Object(M.jsx)(V,{color:"inherit",onClick:function(){t.remove(a),$((function(e){return Object(y.a)(Object(y.a)({},e),{},Object(X.a)({},a,!1))}))},startIcon:Object(M.jsx)(se.a,{}),children:"Delete"})})]}),Object(M.jsx)(h.a,{my:2,children:Object(M.jsx)(oe.a,{component:ue.a,fullWidth:!0,label:"Message",minRows:4,multiline:!0,name:"steps[".concat(a,"].html"),size:"medium",validate:!0,variant:"outlined"})}),Object(M.jsx)(h.a,{my:2,children:Object(M.jsx)(H.a,{control:Object(M.jsx)(oe.a,{component:J.a,name:"steps[".concat(a,"].mask")}),label:"Highlight the message"})}),Object(M.jsxs)($e,{alignItems:"flex-start",my:2,children:[Object(M.jsx)(Ee,{grow:!0,children:Object(M.jsx)(oe.a,{component:ue.a,fullWidth:!0,helperText:"Use the CSS/XPath toggle to choose a selector format",label:"Highlight element",name:"steps[".concat(a,"].selector.value"),size:"medium",variant:"outlined"})}),Object(M.jsx)(Ie,{children:Object(M.jsxs)(Z.a,{onChange:function(){setTimeout((function(){return e.setFieldTouched("steps[".concat(a,"].selector.value"),!0,!0)}))},value:[null!==(r=null===(c=e.values.steps[a].selector)||void 0===c?void 0:c.type)&&void 0!==r?r:"css"],children:[Object(M.jsx)(ee.a,{onClick:function(){return e.setFieldValue("steps[".concat(a,"].selector.type"),"css")},value:"css",children:"CSS"}),Object(M.jsx)(ee.a,{onClick:function(){return e.setFieldValue("steps[".concat(a,"].selector.type"),"xpath")},value:"xpath",children:"XPath"})]})})]})]})]},a)}))})]})}})]})}})})};function Pe(e,t){if(void 0===e.steps||"string"===typeof e.steps)return!1;var n=e.steps[t];return void 0!==n&&void 0!==Object.values(n).find((function(e){return void 0!==e}))}function We(e){return void 0===e?{id:"",match:{regex:""},name:"",status:"draft",steps:[]}:Object(y.a)(Object(y.a)({},e),{},{steps:e.steps.map(Me)})}function Me(e){return void 0===e?{html:"",id:"",mask:!1,selector:{type:"css",value:""}}:void 0!==e.selector?e:Object(y.a)(Object(y.a)({},e),{},{selector:{type:"css",value:""}})}var Ue=Object(d.a)(j.a)({alignItems:"center",display:"flex",flexGrow:1,justifyContent:"center",width:"100%"}),Ae=Object(d.a)(A.a)((function(e){var t=e.theme;return{"&.published:before":{backgroundColor:t.palette.success.main,boxShadow:"0px 0px 5px 1px ".concat(t.palette.success.main)},"&:before":{backgroundColor:t.palette.grey[300],borderRadius:t.spacing(1.5),content:'" "',height:t.spacing(1.5),position:"absolute",right:t.spacing(1),top:t.spacing(1),width:t.spacing(1.5)}}})),Be=function(e){var t=e.managementService,n=Object(v.g)().siteId,a=g((function(){return t.tours$}),[t]),r=Object(l.a)(a,1)[0],c=i.a.useState(!1),s=Object(l.a)(c,2),o=s[0],u=s[1],d=i.a.useState(),j=Object(l.a)(d,2),p=j[0],x=j[1];return i.a.useEffect((function(){t.loadTours(n)}),[t,n]),Object(M.jsxs)(M.Fragment,{children:[void 0!==r&&r.length>0?Object(M.jsxs)(h.a,{width:"100%",children:[Object(M.jsx)(b.a,{component:"h2",my:3,variant:"h2",children:"Tours"}),Object(M.jsx)(h.a,{my:3,children:Object(M.jsx)(V,{color:"primary",onClick:function(){x(void 0),u(!0)},variant:"contained",children:"Create tour"})}),Object(M.jsx)($e,{flexWrap:"wrap",m:-1,children:r.map((function(e){return Object(M.jsx)(h.a,{m:1,width:"23%",children:Object(M.jsx)(Ae,{className:e.status,onClick:function(){x(e),u(!0)},sx:{cursor:"pointer",position:"relative"},children:Object(M.jsx)(B.a,{avatar:Object(M.jsx)(D.a,{sx:{bgcolor:"blue"},children:e.name.split(/\s+/).map((function(e){var t;return null===(t=e[0])||void 0===t?void 0:t.toUpperCase()})).join("")}),title:e.name})})},e.id)}))})]}):void 0!==r?Object(M.jsx)(Ue,{children:Object(M.jsx)(ke,{actionsComponent:Object(M.jsx)(V,{onClick:function(){x(void 0),u(!0)},size:"large",variant:"contained",children:"Create tour"}),illustrationComponent:Object(M.jsx)(G.a,{}),children:"Create your first contextual, interactive experience for your user that is tailored for your website or product."})}):void 0,Object(M.jsx)(qe,{managementService:t,onClose:function(){return u(!1)},onSave:function(){return u(!1)},open:o,siteId:n,tour:p})]})},De=function(e){var t=e.managementService;return Object(M.jsx)(v.d,{children:Object(M.jsx)(v.b,{exact:!0,path:"/sites/:siteId",children:Object(M.jsx)(Be,{managementService:t})})})},Ge=n(370),Ne=n(410),Ve=de.object().shape({code:de.string().required("A 6-digit code is required").matches(/[0-9]{6}/,{message:"A valid 6-digit code is required"})}),Xe=Object(d.a)(h.a)((function(e){return{marginTop:e.theme.spacing(2),textAlign:"right"}})),Le=function(e){var t=e.account,n=e.managementService,a=e.onCancel,i=e.onSignIn,r=void 0===i?function(){}:i;return Object(M.jsx)(oe.d,{initialValues:{code:""},onSubmit:function(){var e=Object(C.a)(S.a.mark((function e(a,i){var c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t){e.next=7;break}return i.setSubmitting(!0),e.next=4,n.authenticate(t.id,a.code);case 4:c=e.sent,i.setSubmitting(!1),r(c);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),validationSchema:Ve,children:function(e){return Object(M.jsxs)(oe.c,{children:[Object(M.jsx)(oe.a,{autoFocus:!0,component:ue.a,fullWidth:!0,helperText:"Check your email and copy your 6 digit sign-in code into this field.",label:"Sign-in code",name:"code"}),Object(M.jsx)(Xe,{children:Object(M.jsxs)(Ne.a,{children:[Object(M.jsx)(V,{onClick:a,size:"large",children:"Cancel"}),Object(M.jsx)(V,{onClick:function(){return e.submitForm()},size:"large",variant:"contained",children:"Sign In"})]})})]})}})},_e=n(380),He=de.object().shape({email:de.string().required("Email address is required").email("Invalid email address")}),Je=Object(d.a)(h.a)((function(e){return{marginTop:e.theme.spacing(2),textAlign:"right"}})),Ye=function(e){var t=e.managementService,n=e.onSignUp;return Object(M.jsx)(oe.d,{initialValues:{email:""},onSubmit:function(){var e=Object(C.a)(S.a.mark((function e(a,i){var r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.setSubmitting(!0),e.next=3,t.signUp(a.email);case 3:r=e.sent,i.setSubmitting(!1),n(r);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),validationSchema:He,children:function(e){return Object(M.jsxs)(oe.c,{children:[Object(M.jsx)(oe.a,{autoFocus:!0,component:ue.a,fullWidth:!0,helperText:"We'll send you a sign-in code to this email address.",label:"Email address",name:"email"}),Object(M.jsx)(Je,{children:Object(M.jsx)(Ne.a,{children:Object(M.jsx)(V,{endIcon:Object(M.jsx)(_e.a,{}),onClick:function(){return e.submitForm()},size:"large",variant:"contained",children:"Next"})})})]})}})},Ke=function(e){var t=e.managementService,n=e.onSignIn,a=i.a.useState(!1),r=Object(l.a)(a,2),c=r[0],s=r[1],o=i.a.useState(),u=Object(l.a)(o,2),d=u[0],j=u[1],b=g((function(){return t.sites$}),[t]),p=Object(l.a)(b,1)[0];return Object(M.jsxs)(Ue,{children:[Object(M.jsx)(Ge.a,{direction:c?"right":"left",in:void 0===d,onEntered:function(){return s(!0)},unmountOnExit:!0,children:Object(M.jsx)(h.a,{position:"absolute",width:1/4,children:Object(M.jsx)(Ye,{managementService:t,onSignUp:j})})}),Object(M.jsx)(Ge.a,{direction:void 0===p?"left":"right",in:void 0!==d&&void 0===p,onExited:function(){void 0!==d&&void 0!==p&&n()},unmountOnExit:!0,children:Object(M.jsx)(h.a,{position:"absolute",width:1/4,children:Object(M.jsx)(Le,{account:d,managementService:t,onCancel:function(){return j(void 0)}})})})]})},Qe=Object(d.a)(j.a)({alignItems:"center",display:"flex",flexDirection:"column",flexGrow:1,width:"100%"}),Ze=Object(d.a)(h.a)({alignItems:"center",display:"flex",flexGrow:1,height:"100%"}),et=Object(d.a)(f.a)((function(e){var t=e.theme;return{height:t.typography.h5.fontSize,marginRight:t.spacing(1),width:t.typography.h5.fontSize}})),tt=Object(d.a)(b.a)((function(e){return{marginRight:e.theme.spacing(4)}})),nt=Object(d.a)(h.a)({display:"flex",flexDirection:"column",height:"100vh"}),at=new T,it=function(){var e=g((function(){return at.account$}),[]),t=Object(l.a)(e,1)[0],n=g((function(){return at.sites$}),[]),a=Object(l.a)(n,1)[0],r=i.a.useState(!1),c=Object(l.a)(r,2),s=c[0],o=c[1],d=i.a.useState(),j=Object(l.a)(d,2),h=j[0],b=j[1];return i.a.useEffect((function(){void 0!==a?b(a[0]):(o(!1),b(void 0))}),[a,h]),Object(M.jsxs)(nt,{children:[Object(M.jsx)(p.a,{position:"static",children:Object(M.jsxs)(x.a,{children:[Object(M.jsx)(et,{}),Object(M.jsx)(tt,{variant:"h6",children:"Enactive Management"}),Object(M.jsx)(Ze,{}),void 0===a?Object(M.jsx)(O.a,{color:"inherit",component:u.b,sx:{height:"100%"},to:"/signin",children:"Sign In"}):void 0!==t&&void 0!==h?Object(M.jsx)(U,{account:t,onSignOut:function(){return at.signOut()}}):void 0]})}),Object(M.jsx)(Qe,{children:Object(M.jsxs)(v.d,{children:[Object(M.jsx)(v.b,{exact:!0,path:"/signin",children:s?Object(M.jsx)(v.a,{to:"/"}):Object(M.jsx)(Ke,{managementService:at,onSignIn:function(){return o(!0)}})}),Object(M.jsx)(v.b,{exact:!0,path:"/",children:void 0===h?Object(M.jsx)(v.a,{to:"/signin"}):Object(M.jsx)(v.a,{to:"/sites/".concat(h.id)})}),Object(M.jsx)(v.b,{path:"/",children:s?Object(M.jsx)(De,{managementService:at}):Object(M.jsx)(v.a,{to:"/signin"})})]})})]})},rt=function(){return Object(M.jsx)(s.a,{injectFirst:!0,children:Object(M.jsx)(u.a,{children:Object(M.jsx)(o.a,{children:Object(M.jsx)(it,{})})})})};n(320);c.a.render(Object(M.jsx)(i.a.StrictMode,{children:Object(M.jsx)(rt,{})}),document.getElementById("enactive-app-root"))}},[[321,1,2]]]);
//# sourceMappingURL=main.6743bb9c.chunk.js.map